<% if @version %>
	<% version = @version %>
	<% disabled = true %>
<% else %>
	<% version ||= @project.versions.build %>
<% end %>

<% remote_form_for :version, :url => {:controller => :scrum_sprints_planning, 
									  :action => :inline_add_version, :project_id => @project},
									  :html => {:id => 'version-form'}, :success => 'hide_field()' do |f| %>

	<div id='version_errors'></div>
	<!--%= error_messages_for 'version' %-->
	
	<div class="box">
	<p>
	<%= f.label :name, l(:field_sprint_name), :class => "scrum_version_inline_label" %>
	<%= f.text_field :name, :size => 55, :required => true, :disabled => disabled, :id => 'version-name' %>
	</p>
	
	<% if @version %>
		<%= hidden_field_tag :version_id, version.id %>
	<%- end -%>
	
	<p>
	<%= f.label :description, l("field_description"), :class => "scrum_version_inline_label" %>
	<%= f.text_field :description, :size => 55 %>
	</p>
	
	<p>
	<%= f.label :release_id, l("field_release_id"), :class => "scrum_version_inline_label" %>
	<%= f.select :release_id, available_releases(@project), {:include_blank => l("field_fixed_release")} %>
	</p>
	
	<p>
	<%= f.label :status, l("field_status"), :class => "scrum_version_inline_label" %>
	<%= f.select :status, Version::VERSION_STATUSES.collect {|s| [l("version_status_#{s}"), s]} %>
	</p>
	
	<% if @version %>
		<p>
		<%= f.label :retrospective_url, l("label_retrospective_url"), :class => "scrum_version_inline_label" %>
		<%= f.text_field :retrospective_url, :label => :label_retrospective_url, :size => 50 %>
		<%= (link_to t('go'), @version.retrospective_url) if @version.retrospective_url && !@version.retrospective_url.empty? %>
		</p>
	<% end %>
	
	<p>
	<%= f.label :effective_date, l("field_effective_date"), :class => "scrum_version_inline_label" %>
	<%= f.text_field :effective_date, :size => 10 %><%= calendar_for('version_effective_date') %>
	</p>
	
	<p>
	<%= f.label :sharing, l("field_sharing"), :class => "scrum_version_inline_label" %>
	<%= f.select :sharing, version.allowed_sharings.collect {|v| [format_version_sharing(v), v]} %>
	</p>
	
	<% version.custom_field_values.each do |value| %>
		<p class='version_custon_field_label'><%= custom_field_tag_with_label :version, value %></p>
	<% end %>
	
	<%= f.submit %>

<% end %>
</div>

